"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[669],{1241:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,o]of t)a[n]=o;return a}},7488:function(e,t,a){function n(e,t,a){const n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);const o="expires="+n.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}function o(e){const t=e+"=",a=decodeURIComponent(document.cookie),n=a.split(";");for(let o=0;o<n.length;o++){let e=n[o];while(" "===e.charAt(0))e=e.substring(1);if(0===e.indexOf(t))return e.substring(t.length,e.length)}return""}function l(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;"}function i(){const e=decodeURIComponent(document.cookie),t=e.split(";");return t.length}t.Ay={setCookie:n,getCookie:o,getCookieNum:i,deleteCookie:l}},1407:function(e,t,a){var n=a(8073);async function o(e,t,a,o){await n.Ay.post("message/create",{send:e,receive:t,title:a,body:o})}async function l(e){const t=await n.Ay.get("message/unreadnumberselect",{receive:e});return console.log(t.data),t.data}t.Ay={createMessage:o,getUnreadMessageNumber:l}},5935:function(e,t,a){function n(e){var t=new Date(e),a=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",o=t.getDate()<10?"0"+t.getDate():t.getDate(),l=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",i=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",s=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a+n+o+" "+l+i+s}function o(e){const t=new Date(e),a=("0"+t.getUTCHours()).slice(-2),n=("0"+t.getUTCMinutes()).slice(-2);return a+":"+n}function l(e){const t=new Date(e),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}月${n}日`}function i(){let e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a=a<10?"0"+a:a,n=n<10?"0"+n:n,`${t}-${a}-${n}`}a.d(t,{Oc:function(){return o},YG:function(){return l},Yq:function(){return n}}),t.Ay={formatDate:n,stampToTime:o,formToDate:l,getCurrentTime:i}},6669:function(e,t,a){a.r(t),a.d(t,{default:function(){return M}});var n=a(6768),o=a(4232),l=a(144),i=a(7488),s=a(8073),u=a(5935),r=a(1219),d=a(1407);const c=e=>((0,n.Qi)("data-v-03d155b0"),e=e(),(0,n.jt)(),e),g=c((()=>(0,n.Lk)("span",{style:{"font-size":"large","font-weight":"600","margin-right":"3%","white-space":"nowrap"}}," 火车餐订单 ",-1))),k=c((()=>(0,n.Lk)("div",{class:"component"},[(0,n.Lk)("hr")],-1))),p={style:{"font-size":"20px"}},f={style:{display:"flex"}},m={style:{"margin-left":"5%"}},b={style:{"font-size":"larger","font-weight":"bold","margin-top":"10%"}},y={style:{color:"#6b778c","margin-top":"10%"}},_={style:{color:"#6b778c","margin-top":"10%"}},h={style:{display:"flex"}},v=c((()=>(0,n.Lk)("span",{style:{"font-size":"larger"}},"请选择支付方式: ",-1))),w=c((()=>(0,n.Lk)("div",{class:"component"},[(0,n.Lk)("hr")],-1))),C=c((()=>(0,n.Lk)("i",{class:"icon-wechat"},null,-1))),F=c((()=>(0,n.Lk)("i",{class:"icon-alipay"},null,-1))),L=c((()=>(0,n.Lk)("i",{class:"icon-bank"},null,-1)));var A={__name:"FoodOrders",setup(e){const t=(0,l.KR)([]);(0,n.sV)((async()=>{const e=await s.Ay.get("/totalorder/getAllFoodReservations",{userId:i.Ay.getCookie("userId")});t.value=e.data,t.value.forEach((e=>{switch(e.active=!1,e.order_time=(0,u.Yq)(e.order_time),e.dialogVisible=!1,e.paymentMethod="",console.log(e.state),e.state){case"PENDING_PAYMENT":e.state="待支付";break;case"PAID":e.state="已支付";break;case"CANCELLED":e.state="已取消";break;default:e.state="未找到";break}"待支付"==e.state?e.buttonText="点击支付":e.buttonText="已支付"})),console.log(t.value)}));const a=async e=>{if(""==e.paymentMethod)return void(0,r.nk)({message:"请选择支付方式！",type:"warning"});const t=await s.Ay.get("/totalorder/pay",{id:e.tid});console.log(t.data),r.nk.success("订餐成功"),await c(e),e.dialogVisible=!1,setTimeout((function(){location.reload()}),300)},c=async e=>{console.log(e),await d.Ay.createMessage("汪汪旅途",i.Ay.getCookie("userId"),"火车餐订购成功",`您的${e.food.trip.train_id}车次的火车餐已购买成功，祝您旅途愉快以及用餐愉快，汪汪~`)},A=async e=>{await s.Ay.get("/totalorder/cancel",{id:e.tid});r.nk.success("订单已取消！"),setTimeout((function(){location.reload()}),300)};return(e,i)=>{const u=(0,n.g2)("el-page-header"),r=(0,n.g2)("el-image"),d=(0,n.g2)("el-row"),c=(0,n.g2)("el-button"),T=(0,n.g2)("el-radio-button"),x=(0,n.g2)("el-radio-group"),M=(0,n.g2)("el-card"),V=(0,n.g2)("el-dialog"),D=(0,n.g2)("el-rol"),U=(0,n.g2)("el-collapse-item"),E=(0,n.g2)("el-collapse");return(0,n.uX)(),(0,n.Wv)(M,{style:{width:"70%"}},{default:(0,n.k6)((()=>[(0,n.bF)(u,null,{content:(0,n.k6)((()=>[g])),_:1}),k,t.value.length>0?((0,n.uX)(!0),(0,n.CE)(n.FK,{key:0},(0,n.pI)(t.value,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"component",key:t.value.id},[(0,n.bF)(M,{style:{width:"70%"}},{header:(0,n.k6)((()=>[(0,n.Lk)("span",p,"订单编号："+(0,o.v_)(e.id),1)])),footer:(0,n.k6)((()=>[(0,n.Lk)("div",h,["待支付"==e.state||"PENDING_PAYMENT"==e.state?((0,n.uX)(),(0,n.Wv)(c,{key:0,onClick:t=>e.dialogVisible=!0,plain:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(e.buttonText),1)])),_:2},1032,["onClick"])):((0,n.uX)(),(0,n.Wv)(c,{key:1,disabled:"true",plain:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(e.buttonText),1)])),_:2},1024)),"已取消"==e.state||"CANCELLED"==e.state?((0,n.uX)(),(0,n.Wv)(c,{key:2,disabled:"true",type:"danger",plain:""},{default:(0,n.k6)((()=>[(0,n.eW)("订单已取消")])),_:1})):((0,n.uX)(),(0,n.Wv)(c,{key:3,onClick:t=>A(e),type:"danger",plain:""},{default:(0,n.k6)((()=>[(0,n.eW)("取消订单")])),_:2},1032,["onClick"]))]),(0,n.bF)(V,{modelValue:e.dialogVisible,"onUpdate:modelValue":t=>e.dialogVisible=t},{default:(0,n.k6)((()=>[(0,n.bF)(M,null,{default:(0,n.k6)((()=>[v,w,(0,n.bF)(x,{modelValue:e.paymentMethod,"onUpdate:modelValue":t=>e.paymentMethod=t},{default:(0,n.k6)((()=>[(0,n.bF)(T,{label:"wechat"},{default:(0,n.k6)((()=>[C])),_:1}),(0,n.bF)(T,{label:"alipay"},{default:(0,n.k6)((()=>[F])),_:1}),(0,n.bF)(T,{label:"bank"},{default:(0,n.k6)((()=>[L])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,n.bF)(c,{onClick:t=>a(e),type:"primary",style:{"margin-left":"15%","margin-top":"10px",height:"40px",width:"200px"}},{default:(0,n.k6)((()=>[(0,n.eW)("确认支付 ")])),_:2},1032,["onClick"]),(0,n.bF)(c,{onClick:t=>e.dialogVisible=!1,style:{"margin-left":"20%","margin-top":"10px",height:"40px",width:"200px"}},{default:(0,n.k6)((()=>[(0,n.eW)("返回 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,n.bF)(E,{modelValue:e.active,"onUpdate:modelValue":t=>e.active=t},{default:(0,n.k6)((()=>[(0,n.bF)(U,{name:"1",title:"点击显示更多信息"},{default:(0,n.k6)((()=>[(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"乘车人："+(0,o.v_)(e.user.user_name),1)])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"出行车次："+(0,o.v_)(e.food.trip.train_id),1)])),_:2},1024),(0,n.bF)(D,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"下单时间："+(0,o.v_)(e.order_time),1)])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"支付状态："+(0,o.v_)(e.state),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),default:(0,n.k6)((()=>[(0,n.Lk)("div",f,[(0,n.Lk)("div",null,[(0,n.bF)(r,{src:(0,l.R1)(s.Tt)()+e.food.picture_path,height:"100px",width:"150px"},null,8,["src"])]),(0,n.Lk)("div",m,[(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",b,(0,o.v_)(e.food.name),1)])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",y,"餐品数量："+(0,o.v_)(e.quantity),1)])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",_,"总价：￥"+(0,o.v_)((e.quantity*e.food.price).toFixed(2)),1)])),_:2},1024)])])])),_:2},1024)])))),128)):(0,n.Q3)("",!0)])),_:1})}}},T=a(1241);const x=(0,T.A)(A,[["__scopeId","data-v-03d155b0"]]);var M=x}}]);
//# sourceMappingURL=669.c2b1df8b.js.map