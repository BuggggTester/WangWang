{"version":3,"file":"js/116.6f1e5744.js","mappings":"qGAAO,SAASA,EAAUC,EAAMC,EAAOC,GACnC,MAAMC,EAAI,IAAIC,KACdD,EAAEE,QAAQF,EAAEG,UAAoB,GAAPJ,EAAY,GAAK,GAAK,KAC/C,MAAMK,EAAU,WAAaJ,EAAEK,cAC/BC,SAASC,OAASV,EAAO,IAAMC,EAAQ,IAAMM,EAAU,SAC3D,CAIO,SAASI,EAAUX,GACtB,MAAMY,EAAaZ,EAAO,IACpBa,EAAgBC,mBAAmBL,SAASC,QAC5CK,EAAcF,EAAcG,MAAM,KACxC,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAYG,OAAQD,IAAK,CACzC,IAAIP,EAASK,EAAYE,GACzB,MAA4B,MAArBP,EAAOS,OAAO,GACjBT,EAASA,EAAOU,UAAU,GAE9B,GAAmC,IAA/BV,EAAOW,QAAQT,GACf,OAAOF,EAAOU,UAAUR,EAAWM,OAAQR,EAAOQ,OAE1D,CACA,MAAO,EACX,CAIO,SAASI,EAAaV,GACzBH,SAASC,OAASE,EAAa,mDACnC,CACO,SAASW,IACZ,MAAMV,EAAgBC,mBAAmBL,SAASC,QAC5CK,EAAcF,EAAcG,MAAM,KACxC,OAAOD,EAAYG,MACvB,CACA,MACInB,YAAUY,YAAUY,eAAaD,e,4WC0BrC,MAAME,GAAWC,EAAAA,EAAAA,IAAI,MACfC,EAAWC,EAAAA,GAAAA,UAAqB,YAChCC,EAAUD,EAAAA,GAAAA,UAAqB,YAC/BE,EAAUF,EAAAA,GAAAA,UAAqB,cACrCG,QAAQC,IAAIF,GACZ,MAAMG,GAAWP,EAAAA,EAAAA,IAAI,CACnBQ,SAAUP,EACVQ,SAAUN,EACVO,WAAYN,IAERO,GAAaX,EAAAA,EAAAA,IAAI,CACrBY,QAAS,CAAC,CAAEC,UAAU,EAAMC,QAAS,OAAQC,QAAS,YACtDN,SAAU,CAAC,CAAEI,UAAU,EAAMC,QAAS,OAAQC,QAAS,cAGnDC,EAAcA,KAClBjB,EAASvB,MAAMyC,UAASC,UACtB,GAAGC,EAAO,CACR,MAAMC,QAAYC,EAAAA,GAAAA,KAAiB,cAAc,CAC/C,SAAYd,EAAU/B,MAAMgC,SAC5B,SAAYD,EAAU/B,MAAMiC,WAE9BJ,QAAQC,IAAIc,GACTb,EAAU/B,MAAMkC,YACjBR,EAAAA,GAAAA,UAAqB,WAAYK,EAAU/B,MAAMgC,SAAU,GAC3DN,EAAAA,GAAAA,UAAqB,SAAUkB,EAAIE,KAAKC,OAAQ,GAChDrB,EAAAA,GAAAA,UAAqB,WAAYkB,EAAIE,KAAKb,SAAS,GACnDP,EAAAA,GAAAA,UAAqB,aAAcK,EAAU/B,MAAMkC,WAAY,GAC/DR,EAAAA,GAAAA,UAAqB,WAAW,EAAM,KAGtCA,EAAAA,GAAAA,UAAqB,WAAYK,EAAU/B,MAAMgC,SAAU,GAC3DN,EAAAA,GAAAA,UAAqB,SAAUkB,EAAIE,KAAKC,OAAQ,GAChDrB,EAAAA,GAAAA,UAAqB,WAAYkB,EAAIE,KAAKb,SAAS,GACnDP,EAAAA,GAAAA,UAAqB,aAAcK,EAAU/B,MAAMkC,WAAY,GAC/DR,EAAAA,GAAAA,UAAqB,WAAW,EAAM,IAEpB,kBAAjBkB,EAAIE,KAAKE,MACVC,EAAAA,EAAAA,IAAU,CACRV,QAAS,QACTW,KAAM,kBAEFC,EAAAA,EAAOC,KAAK,WAElBH,EAAAA,EAAAA,IAAU,CACRV,QAAS,gBACTW,KAAM,WAGZ,IACA,EAEEG,EAAiBA,KACrBF,EAAAA,EAAOC,KAAK,YAAY,E,giDC9G1B,MAAME,EAAc,EAEpB,O","sources":["webpack://vue/./src/util/cookie.js","webpack://vue/./src/views/Login.vue","webpack://vue/./src/views/Login.vue?240b"],"sourcesContent":["export function setCookie(name, value, days) {\r\n    const d = new Date();\r\n    d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));\r\n    const expires = \"expires=\" + d.toUTCString();\r\n    document.cookie = name + \"=\" + value + \";\" + expires + \";path=/\";\r\n}\r\n/*\r\n设置cookie\r\n */\r\nexport function getCookie(name) {\r\n    const cookieName = name + \"=\";\r\n    const decodedCookie = decodeURIComponent(document.cookie);\r\n    const cookieArray = decodedCookie.split(';');\r\n    for (let i = 0; i < cookieArray.length; i++) {\r\n        let cookie = cookieArray[i];\r\n        while (cookie.charAt(0) === ' ') {\r\n            cookie = cookie.substring(1);\r\n        }\r\n        if (cookie.indexOf(cookieName) === 0) {\r\n            return cookie.substring(cookieName.length, cookie.length);\r\n        }\r\n    }\r\n    return \"\";\r\n}\r\n/*\r\n获取cookie\r\n */\r\nexport function deleteCookie(cookieName) {\r\n    document.cookie = cookieName + '=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;';\r\n}\r\nexport function getCookieNum(){\r\n    const decodedCookie = decodeURIComponent(document.cookie);\r\n    const cookieArray = decodedCookie.split(';');\r\n    return cookieArray.length;\r\n}\r\nexport default {\r\n    setCookie,getCookie,getCookieNum,deleteCookie\r\n}","<template>\r\n  <div class=\"login-page\">\r\n    <el-form ref=\"loginRef\" :model=\"loginForm\" :rules=\"loginRules\" class=\"login-form\">\r\n      <el-form-item prop=\"username\">\r\n        <h1 class=\"title\">登录</h1>\r\n        <el-input\r\n            v-model=\"loginForm.username\"\r\n            type=\"text\"\r\n            size=\"large\"\r\n            auto-complete=\"off\"\r\n            placeholder=\"账号\"\r\n        >\r\n          <template #prefix><svg-icon icon=\"user\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item style=\"width: 100%;\">\r\n        <el-input\r\n            v-model=\"loginForm.password\"\r\n            type=\"password\"\r\n            size=\"large\"\r\n            auto-complete=\"off\"\r\n            placeholder=\"密码\"\r\n            @keyup.enter=\"handleLogin\"\r\n        >\r\n          <template #prefix><svg-icon icon=\"password\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n      <el-checkbox v-model=\"loginForm.rememberMe\">记住密码</el-checkbox>\r\n        <span class=\"toLogin\" >忘记密码？</span>\r\n      </el-form-item>\r\n      <el-form-item style=\"width:100%;\">\r\n        <el-button\r\n            size=\"large\"\r\n            type=\"primary\"\r\n            style=\"width:40%;margin-left: 5%\"\r\n            @click.prevent=\"handleLogin\"\r\n        >\r\n          <span>登 录</span>\r\n        </el-button>\r\n        <el-button\r\n            size=\"large\"\r\n            type=\"default\"\r\n            style=\"width:40%; margin-left: 10%\"\r\n            @click.prevent=\"handleRegister\"\r\n        >\r\n          <span>注 册</span>\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { User } from '@element-plus/icons-vue'\r\n\r\nimport {onMounted, ref} from \"vue\";\r\nimport router from \"@/router\";\r\nimport requestUtil from \"@/util/request\"\r\nimport {ElMessage} from \"element-plus\";\r\nimport cookieUtil from \"@/util/cookie\"\r\n\r\nconst loginRef = ref(null);\r\nconst lastUser = cookieUtil.getCookie(\"userName\");\r\nconst lastPwd = cookieUtil.getCookie(\"password\");\r\nconst lastRem = cookieUtil.getCookie(\"rememberMe\");\r\nconsole.log(lastRem);\r\nconst loginForm =ref({\r\n  username: lastUser,\r\n  password: lastPwd,\r\n  rememberMe: lastRem\r\n})\r\nconst loginRules = ref({\r\n  account: [{ required: true, trigger: \"blur\", message: \"请输入您的账号\" }],\r\n  password: [{ required: true, trigger: \"blur\", message: \"请输入您的密码\" }],\r\n\r\n})\r\nconst handleLogin = ()=>{\r\n  loginRef.value.validate(async(valid)=> {\r\n    if(valid) {\r\n      const res = await requestUtil.post('/user/login',{\r\n        \"userName\": loginForm.value.username,\r\n        \"password\": loginForm.value.password\r\n      });\r\n      console.log(res);\r\n      if(loginForm.value.rememberMe) {\r\n        cookieUtil.setCookie(\"userName\", loginForm.value.username, 3);\r\n        cookieUtil.setCookie(\"userId\", res.data.userId, 3);\r\n        cookieUtil.setCookie(\"password\", res.data.password,3);\r\n        cookieUtil.setCookie(\"rememberMe\", loginForm.value.rememberMe, 3);\r\n        cookieUtil.setCookie(\"ifLogin\", true, 3);\r\n        //TODO: 后续添加其他cookie\r\n      }else {\r\n        cookieUtil.setCookie(\"userName\", loginForm.value.username, 1);\r\n        cookieUtil.setCookie(\"userId\", res.data.userId, 1);\r\n        cookieUtil.setCookie(\"password\", res.data.password,1);\r\n        cookieUtil.setCookie(\"rememberMe\", loginForm.value.rememberMe, 1);\r\n        cookieUtil.setCookie(\"ifLogin\", true, 1);\r\n      }\r\n      if(res.data.msg === 'login success'){\r\n        ElMessage({\r\n          message: \"登陆成功！\",\r\n          type: \"success\"\r\n        })\r\n        await router.push('/main');\r\n      }else {\r\n        ElMessage({\r\n          message: \"登录失败，用户名或密码错误\",\r\n          type: \"warning\"\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\nconst handleRegister = () => {\r\n  router.push('/register');\r\n}\r\n</script>\r\n\r\n<style>\r\n.login-form {\r\n  border-radius: 6px;\r\n  background: #ffffff;\r\n  width: 400px;\r\n  padding: 25px 25px 5px 25px;\r\n\r\n  .el-input {\r\n    height: 40px;\r\n\r\n\r\n\r\n    input {\r\n      display: inline-block;\r\n      height: 40px;\r\n    }\r\n  }\r\n  .input-icon {\r\n    height: 39px;\r\n    width: 14px;\r\n    margin-left: 0px;\r\n  }\r\n\r\n}\r\n.login-page{\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  background-image: url(\"../assets/images/login/login.png\");\r\n  background-size: cover;\r\n}\r\n.title {\r\n  margin: 0px auto 30px auto;\r\n  text-align: center;\r\n  color: #707070;\r\n  font-size: larger;\r\n  font-weight: bold;\r\n}\r\n.toLogin {\r\n  color: #25a4bb;\r\n  cursor: pointer;\r\n  margin-left: 60%;\r\n}\r\n</style>\r\n","import script from \"./Login.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Login.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=47ecd615&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["setCookie","name","value","days","d","Date","setTime","getTime","expires","toUTCString","document","cookie","getCookie","cookieName","decodedCookie","decodeURIComponent","cookieArray","split","i","length","charAt","substring","indexOf","deleteCookie","getCookieNum","loginRef","ref","lastUser","cookieUtil","lastPwd","lastRem","console","log","loginForm","username","password","rememberMe","loginRules","account","required","trigger","message","handleLogin","validate","async","valid","res","requestUtil","data","userId","msg","ElMessage","type","router","push","handleRegister","__exports__"],"sourceRoot":""}