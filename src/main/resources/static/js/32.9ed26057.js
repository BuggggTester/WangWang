"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[32],{1241:function(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[n,l]of t)a[n]=l;return a}},7488:function(e,t,a){function n(e,t,a){const n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);const l="expires="+n.toUTCString();document.cookie=e+"="+t+";"+l+";path=/"}function l(e){const t=e+"=",a=decodeURIComponent(document.cookie),n=a.split(";");for(let l=0;l<n.length;l++){let e=n[l];while(" "===e.charAt(0))e=e.substring(1);if(0===e.indexOf(t))return e.substring(t.length,e.length)}return""}function s(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;"}function i(){const e=decodeURIComponent(document.cookie),t=e.split(";");return t.length}t.Ay={setCookie:n,getCookie:l,getCookieNum:i,deleteCookie:s}},5935:function(e,t,a){function n(e){var t=new Date(e),a=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",l=t.getDate()<10?"0"+t.getDate():t.getDate(),s=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",i=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",o=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a+n+l+" "+s+i+o}function l(e){const t=new Date(e),a=("0"+t.getUTCHours()).slice(-2),n=("0"+t.getUTCMinutes()).slice(-2);return a+":"+n}function s(e){const t=new Date(e),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}月${n}日`}function i(){let e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a=a<10?"0"+a:a,n=n<10?"0"+n:n,`${t}-${a}-${n}`}a.d(t,{Oc:function(){return l},YG:function(){return s},Yq:function(){return n}}),t.Ay={formatDate:n,stampToTime:l,formToDate:s,getCurrentTime:i}},5738:function(e,t,a){a.d(t,{A:function(){return x}});var n=a(6768),l=a(4232);const s=e=>((0,n.Qi)("data-v-5a85c12d"),e=e(),(0,n.jt)(),e),i={style:{display:"flex"}},o={style:{width:"80%"}},u={class:"component"},r={style:{"font-size":"larger",color:"#12a72b"}},c=s((()=>(0,n.Lk)("div",{class:"component"},[(0,n.Lk)("hr",{style:{color:"#6b778c"}})],-1))),d={class:"component"},p={class:"component"},k={style:{width:"20%",display:"flex","justify-content":"center","align-items":"center"}},g=s((()=>(0,n.Lk)("div",{class:"component"},[(0,n.Lk)("hr",{style:{color:"#6b778c"}})],-1))),m={class:"component"},y=s((()=>(0,n.Lk)("span",{style:{"margin-right":"2%"}},[(0,n.eW)("请输入姓名："),(0,n.Lk)("span",{style:{color:"red"}},"*")],-1))),v={class:"component"},f=s((()=>(0,n.Lk)("span",{style:{"margin-right":"2%"}},[(0,n.eW)("请输入手机号："),(0,n.Lk)("span",{style:{color:"red"}},"*")],-1))),_={class:"component"},b=s((()=>(0,n.Lk)("span",{style:{"margin-right":"2%"}},[(0,n.eW)("请输入身份证号："),(0,n.Lk)("span",{style:{color:"red"}},"*")],-1)));function h(e,t,a,s,h,w){const F=(0,n.g2)("el-col"),L=(0,n.g2)("el-row"),W=(0,n.g2)("EditPen"),C=(0,n.g2)("el-icon"),T=(0,n.g2)("el-card"),x=(0,n.g2)("el-input"),A=(0,n.g2)("el-button"),P=(0,n.g2)("el-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(T,{style:{width:"100%"}},{default:(0,n.k6)((()=>[(0,n.Lk)("div",i,[(0,n.Lk)("div",o,[(0,n.Lk)("div",u,[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.bF)(F,{span:4},{default:(0,n.k6)((()=>[(0,n.Lk)("span",r,(0,l.v_)(a.passenger.name),1)])),_:1})])),_:1})]),c,(0,n.Lk)("div",d,[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"手机号: "+(0,l.v_)(a.passenger.phone_number),1)])),_:1})]),(0,n.Lk)("div",p,[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,"身份证号: "+(0,l.v_)(s.maskedIdentity),1)])),_:1})])]),(0,n.Lk)("div",k,[(0,n.Lk)("div",{onClick:t[0]||(t[0]=e=>a.passenger.dialogVisible=!0)},[(0,n.bF)(C,{size:"40px",color:"gray"},{default:(0,n.k6)((()=>[(0,n.bF)(W)])),_:1})])])])])),_:1}),(0,n.bF)(P,{modelValue:a.passenger.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>a.passenger.dialogVisible=e),title:"修改乘车人信息"},{footer:(0,n.k6)((()=>[(0,n.bF)(A,{onClick:t[4]||(t[4]=e=>a.passenger.dialogVisible=!1),type:"default"},{default:(0,n.k6)((()=>[(0,n.eW)("返回")])),_:1}),(0,n.bF)(A,{onClick:s.handleModify,type:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)("修改信息")])),_:1},8,["onClick"])])),default:(0,n.k6)((()=>[g,(0,n.Lk)("div",m,[y,(0,n.bF)(x,{modelValue:s.newName,"onUpdate:modelValue":t[1]||(t[1]=e=>s.newName=e),placeholder:"请输入名字",style:{width:"65%"}},null,8,["modelValue"])]),(0,n.Lk)("div",v,[f,(0,n.bF)(x,{modelValue:s.newPhone,"onUpdate:modelValue":t[2]||(t[2]=e=>s.newPhone=e),placeholder:"请输入手机号",style:{width:"63%"}},null,8,["modelValue"])]),(0,n.Lk)("div",_,[b,(0,n.bF)(x,{modelValue:s.newIdentity,"onUpdate:modelValue":t[3]||(t[3]=e=>s.newIdentity=e),placeholder:"请输入身份证号",style:{width:"61%"}},null,8,["modelValue"])])])),_:1},8,["modelValue"])],64)}var w=a(8073),F=a(144),L=a(1219),W={props:{passenger:Object},setup(e){const t=(0,F.KR)(""),a=(0,F.KR)(""),l=(0,F.KR)(""),s=async()=>{if(""!==t.value)if(""!==a.value)if(""!==l.value)try{const n=await w.Ay.post("/passenger/modify",{pid:e.passenger.pid,name:t.value,identity:a.value,phoneNum:l.value});"200"==n.data.code?((0,L.nk)({message:"修改成功！",type:"success"}),setTimeout((function(){location.reload()}),500)):("illegal identity"===n.data.msg&&(0,L.nk)({message:"请输入正确的身份证号",type:"warning"}),"illegal phone"===n.data.msg&&(0,L.nk)({message:"请输入正确的的手机号",type:"warning"}))}catch(n){(0,L.nk)({message:"修改失败",type:"error"})}else(0,L.nk)({message:"请输入电话号！",type:"warning"});else(0,L.nk)({message:"请输入身份证号！",type:"warning"});else(0,L.nk)({message:"请输入姓名！",type:"warning"})},i=(0,n.EW)((()=>{const t=e.passenger.identity.toString(),a=t.length;if(a<3)return t;const n=a-7,l="*".repeat(n);return t.substring(0,3)+l+t.substring(a-4)}));return{maskedIdentity:i,handleModify:s,newName:t,newPhone:l,newIdentity:a}}},C=a(1241);const T=(0,C.A)(W,[["render",h],["__scopeId","data-v-5a85c12d"]]);var x=T},8032:function(e,t,a){a.r(t),a.d(t,{default:function(){return M}});a(4114);var n=a(6768),l=a(144),s=a(4232),i=a(1387),o=a(8073),u=a(5935),r=(a(5738),a(1219),a(7488)),c=a(9325),d=a(7477);const p=e=>((0,n.Qi)("data-v-fbd50d06"),e=e(),(0,n.jt)(),e),k={class:"component"},g=p((()=>(0,n.Lk)("span",{class:"head-trip-info"},"车次详情",-1))),m=p((()=>(0,n.Lk)("div",{class:"component"},[(0,n.Lk)("hr")],-1))),y=p((()=>(0,n.Lk)("div",{class:"spacer"},null,-1))),v={class:"ticket-info"},f=p((()=>(0,n.Lk)("div",{class:"underline-container"},[(0,n.Lk)("span",{class:"underline-text"},"时刻表")],-1))),_={class:"buy-boarder"},b={style:{"align-items":"center"}},h={key:0,class:"availability"},w={key:1,span:6,class:"unavailability"},F={class:"button-container"},L={class:"buy-boarder"},W={style:{"align-items":"center"}},C={key:0,class:"availability"},T={key:1,span:6,class:"unavailability"},x={class:"button-container"},A={class:"buy-boarder"},P={style:{"align-items":"center"}},V={key:0,class:"availability"},I={key:1,span:6,class:"unavailability"},R={class:"button-container"};var D={__name:"TicketDetail",setup(e){const t=(0,i.lq)(),a=(0,l.KR)(t.query.trip_id),p=(0,l.KR)(""),D=(0,l.KR)(""),K=(0,l.KR)(""),X=((0,l.KR)(!1),(0,l.KR)([]));(0,l.KR)(!1),(0,l.KR)(""),(0,l.KR)(""),(0,l.KR)("");(0,n.sV)((async()=>{try{const e=await o.Ay.get("/trip/select/tripId",{tripId:a.value});p.value=e.data,p.value.start_time=u.Ay.stampToTime(u.Ay.formatDate(p.value.start_time)),p.value.end_time=u.Ay.stampToTime(u.Ay.formatDate(p.value.end_time))}catch(l){console.error(l)}console.log(p);const e=await o.Ay.get("/trip/sum",{tripId:a.value,fromPlace:p.value.from_place,toPlace:p.value.to_place}),t=await o.Ay.get("/trip/minPrice",{tripId:a.value,fromPlace:p.value.from_place,toPlace:p.value.to_place});console.log(e.data.firstSeats),p.value.first_seat=e.data.firstSeats,p.value.second_seat=e.data.secondSeats,D.value=e.data.time,K.value=t.data.minPrice;const n=await o.Ay.get("/passenger/select/userId",{userId:r.Ay.getCookie("userId")});X.value=n.data,X.value.forEach((e=>{e.dialogVisible=!1})),console.log(X.value)}));const M=()=>{let e={fromPlace:t.query.fromPlace,toPlace:t.query.toPlace,startTime:t.query.startTime};c.A.push({path:"/ticket",query:e})},S=e=>{let n={trip_id:a.value,fromPlace:t.query.fromPlace,toPlace:t.query.toPlace,startTime:p.value.start_time,endTime:p.value.end_time,price:K.value,seatType:e,train_id:t.query.train_id};c.A.push({path:"/TicketOrderPrepare",query:n})};return(e,t)=>{const a=(0,n.g2)("el-page-header"),i=(0,n.g2)("el-col"),o=(0,n.g2)("el-row"),u=(0,n.g2)("el-button"),r=(0,n.g2)("el-card");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",k,[(0,n.bF)(a,{icon:(0,l.R1)(d.ArrowLeft),onBack:M},{content:(0,n.k6)((()=>[g])),_:1},8,["icon"])]),m,(0,n.bF)(r,{class:"page-container"},{default:(0,n.k6)((()=>[y,(0,n.Lk)("div",null,[(0,n.Lk)("div",v,[(0,n.bF)(o,{class:"component"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{span:8,class:"ticket-time"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(p.value.start_time),1)])),_:1}),(0,n.bF)(i,{span:8,class:"trip-no"},{default:(0,n.k6)((()=>[f])),_:1}),(0,n.bF)(i,{span:8,class:"ticket-time"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(p.value.end_time),1)])),_:1})])),_:1}),(0,n.bF)(o,{class:"component"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{span:8,class:"ticket-place"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(p.value.from_place),1)])),_:1}),(0,n.bF)(i,{span:8,class:"time"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(p.value.train_id)+" · "+(0,s.v_)(D.value),1)])),_:1}),(0,n.bF)(i,{span:8,class:"ticket-place"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(p.value.to_place),1)])),_:1})])),_:1})]),(0,n.Lk)("div",_,[(0,n.bF)(o,null,{default:(0,n.k6)((()=>[(0,n.bF)(i,{span:8,class:"ticket-level"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",b,[(0,n.eW)("二等座 "),p.value.second_seat>0?((0,n.uX)(),(0,n.CE)("span",h,"有票")):((0,n.uX)(),(0,n.CE)("span",w,"无票"))])])),_:1}),(0,n.bF)(i,{span:8,class:"ticket-price"},{default:(0,n.k6)((()=>[(0,n.eW)(" ￥"+(0,s.v_)((1*K.value).toFixed(2)),1)])),_:1}),(0,n.bF)(i,{span:8,class:"buy-nutton"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",F,[p.value.first_seat>0?((0,n.uX)(),(0,n.Wv)(u,{key:0,onClick:t[0]||(t[0]=e=>S("second")),type:"primary",size:"mini",style:{height:"40px",width:"130px"}},{default:(0,n.k6)((()=>[(0,n.eW)(" 订购 ")])),_:1})):((0,n.uX)(),(0,n.Wv)(u,{key:1,type:"primary",size:"mini",style:{height:"40px",width:"130px"},disabled:"true"},{default:(0,n.k6)((()=>[(0,n.eW)("订购")])),_:1}))])])),_:1})])),_:1})]),(0,n.Lk)("div",L,[(0,n.bF)(o,null,{default:(0,n.k6)((()=>[(0,n.bF)(i,{span:8,class:"ticket-level"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",W,[(0,n.eW)("一等座 "),p.value.first_seat>0?((0,n.uX)(),(0,n.CE)("span",C,"有票")):((0,n.uX)(),(0,n.CE)("span",T,"无票"))])])),_:1}),(0,n.bF)(i,{span:8,class:"ticket-price"},{default:(0,n.k6)((()=>[(0,n.eW)(" ￥"+(0,s.v_)((1.2*K.value).toFixed(2)),1)])),_:1}),(0,n.bF)(i,{span:8,class:"buy-nutton"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",x,[p.value.first_seat>0?((0,n.uX)(),(0,n.Wv)(u,{key:0,onClick:t[1]||(t[1]=e=>S("first")),type:"primary",size:"mini",style:{height:"40px",width:"130px"}},{default:(0,n.k6)((()=>[(0,n.eW)(" 订购 ")])),_:1})):((0,n.uX)(),(0,n.Wv)(u,{key:1,type:"primary",size:"mini",style:{height:"40px",width:"130px"},disabled:"true"},{default:(0,n.k6)((()=>[(0,n.eW)("订购")])),_:1}))])])),_:1})])),_:1})]),(0,n.Lk)("div",A,[(0,n.bF)(o,null,{default:(0,n.k6)((()=>[(0,n.bF)(i,{span:8,class:"ticket-level"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",P,[(0,n.eW)("商务座 "),p.value.first_seat>0||p.value.second_seat>0?((0,n.uX)(),(0,n.CE)("span",V,"有票")):((0,n.uX)(),(0,n.CE)("span",I,"无票"))])])),_:1}),(0,n.bF)(i,{span:8,class:"ticket-price"},{default:(0,n.k6)((()=>[(0,n.eW)(" ￥"+(0,s.v_)((1.5*K.value).toFixed(2)),1)])),_:1}),(0,n.bF)(i,{span:8,class:"buy-nutton"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",R,[p.value.first_seat>0?((0,n.uX)(),(0,n.Wv)(u,{key:0,onClick:t[2]||(t[2]=e=>S("business")),type:"primary",size:"mini",style:{height:"40px",width:"130px"}},{default:(0,n.k6)((()=>[(0,n.eW)(" 订购 ")])),_:1})):((0,n.uX)(),(0,n.Wv)(u,{key:1,type:"primary",size:"mini",style:{height:"40px",width:"130px"},disabled:"true"},{default:(0,n.k6)((()=>[(0,n.eW)("订购")])),_:1}))])])),_:1})])),_:1})])])])),_:1})],64)}}},K=a(1241);const X=(0,K.A)(D,[["__scopeId","data-v-fbd50d06"]]);var M=X}}]);
//# sourceMappingURL=32.9ed26057.js.map